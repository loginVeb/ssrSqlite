'use client' // –î–∏—Ä–µ–∫—Ç–∏–≤–∞ Next.js - –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–µ —Ö—É–∫–∏

// –ò–º–ø–æ—Ä—Ç —Å—Ç–∏–ª–µ–π –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –∏–∑ CSS-–º–æ–¥—É–ª—è
import styles from "./mapAdmin.module.css";
// –ò–º–ø–æ—Ä—Ç –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ —Ö—É–∫–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—Å–µ–π –ª–æ–≥–∏–∫–æ–π –∫–∞—Ä—Ç—ã
import { useMapAdminLogic } from "./logic/useMapAdminLogic";
// –ò–º–ø–æ—Ä—Ç –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ —Ö—É–∫–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∑–æ–Ω
import { useEditZoneLogic } from "./logic/zoneLogic/useEditZoneLogic";

// –ì–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∞–¥–º–∏–Ω—Å–∫–æ–π –∫–∞—Ä—Ç—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–æ–Ω–∞–º–∏ –∏ –º–∞—Ä–∫–µ—Ä–∞–º–∏
export default function MapAdmin() {
  // –î–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∏–∑ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ —Ö—É–∫–∞
  const { 
    mapContainer, // Ref –¥–ª—è DOM-—ç–ª–µ–º–µ–Ω—Ç–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∫–∞—Ä—Ç—ã
    mapInstance, // Ref –¥–ª—è —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –∫–∞—Ä—Ç—ã MapLibre
    handleSaveZones, // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∑–æ–Ω –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
    isSaving, // –§–ª–∞–≥ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è (true –≤–æ –≤—Ä–µ–º—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è)
    drawInstance, // Ref –¥–ª—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞ —Ä–∏—Å–æ–≤–∞–Ω–∏—è Mapbox Draw
    handleDeleteZoneByClick, // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∑–æ–Ω—ã –ø–æ –∫–ª–∏–∫—É
    isAddingMarkers, // –§–ª–∞–≥ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –º–∞—Ä–∫–µ—Ä–æ–≤
    setIsAddingMarkers, // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –º–∞—Ä–∫–µ—Ä–æ–≤
    markers, // –ú–∞—Å—Å–∏–≤ –≤—Å–µ—Ö –º–∞—Ä–∫–µ—Ä–æ–≤ –Ω–∞ –∫–∞—Ä—Ç–µ
    zones, // –ú–∞—Å—Å–∏–≤ –≤—Å–µ—Ö –∑–æ–Ω –Ω–∞ –∫–∞—Ä—Ç–µ
    setZones // –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–æ–Ω
  } = useMapAdminLogic();

  // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ö—É–∫–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∑–æ–Ω
  const { 
    isEditing, // –§–ª–∞–≥ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    toggleEditMode // –§—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
  } = useEditZoneLogic(mapInstance, drawInstance, zones, setZones);

  return (
    // –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤—Å–µ–π –∞–¥–º–∏–Ω—Å–∫–æ–π –∫–∞—Ä—Ç—ã
    <div className={styles.mapAdminContainer}>
      {/* –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å –∫–Ω–æ–ø–∫–∞–º–∏ –¥–µ–π—Å—Ç–≤–∏–π */}
      <div className={styles.controlsPanel}>
        
        {/* –ö–Ω–æ–ø–∫–∞ –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –≤ —Ä–µ–∂–∏–º —Ä–∏—Å–æ–≤–∞–Ω–∏—è –ø–æ–ª–∏–≥–æ–Ω–æ–≤ */}
        <button 
          onClick={() => drawInstance?.current?.changeMode('draw_polygon')} // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º —Ä–µ–∂–∏–º —Ä–∏—Å–æ–≤–∞–Ω–∏—è –Ω–∞ 'draw_polygon'
          className={styles.controlButton} // –ü—Ä–∏–º–µ–Ω—è–µ–º —Å—Ç–∏–ª–∏ –∫–Ω–æ–ø–∫–∏
          title="–†–∏—Å–æ–≤–∞—Ç—å –ø–æ–ª–∏–≥–æ–Ω" // –í—Å–ø–ª—ã–≤–∞—é—â–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏
        >
          üî∫ –ü–æ–ª–∏–≥–æ–Ω {/* –ò–∫–æ–Ω–∫–∞ –∏ —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ */}
        </button>
      
        {/* –ö–Ω–æ–ø–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –∑–æ–Ω –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö */}
        <button 
          onClick={handleSaveZones} // –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–∏ –∫–ª–∏–∫–µ
          className={styles.controlButton} // –ü—Ä–∏–º–µ–Ω—è–µ–º —Å—Ç–∏–ª–∏ –∫–Ω–æ–ø–∫–∏
          disabled={isSaving} // –û—Ç–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫—É –≤–æ –≤—Ä–µ–º—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
          title="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ –∑–æ–Ω—ã" // –í—Å–ø–ª—ã–≤–∞—é—â–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞
        >
          {isSaving ? 'üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...' : 'üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–æ–Ω—ã'} {/* –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ */}
        </button>

        {/* –ö–Ω–æ–ø–∫–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∑–æ–Ω—ã –ø–æ –∫–ª–∏–∫—É */}
        <button 
          onClick={handleDeleteZoneByClick} // –í—ã–∑—ã–≤–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é —É–¥–∞–ª–µ–Ω–∏—è –ø—Ä–∏ –∫–ª–∏–∫–µ
          className={styles.controlButton} // –ü—Ä–∏–º–µ–Ω—è–µ–º —Å—Ç–∏–ª–∏ –∫–Ω–æ–ø–∫–∏
          title="–£–¥–∞–ª–∏—Ç—å –∑–æ–Ω—É" // –í—Å–ø–ª—ã–≤–∞—é—â–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞
        >
          üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –∑–æ–Ω—É {/* –ò–∫–æ–Ω–∫–∞ –∏ —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ */}
        </button>
        
        {/* –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –º–∞—Ä–∫–µ—Ä–æ–≤ */}
        <button 
          onClick={() => setIsAddingMarkers(!isAddingMarkers)} // –ò–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ —Ñ–ª–∞–≥–∞
          className={`${styles.controlButton} ${isAddingMarkers ? styles.active : ''}`} // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å 'active' –ø—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ–º —Ä–µ–∂–∏–º–µ
          title={isAddingMarkers ? '–û—Ç–º–µ–Ω–∏—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ä–∫–µ—Ä–æ–≤' : '–î–æ–±–∞–≤–∏—Ç—å –º–∞—Ä–∫–µ—Ä'} // –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞
        >
          {isAddingMarkers ? '‚ùå –û—Ç–º–µ–Ω–∞' : 'üìç –î–æ–±–∞–≤–∏—Ç—å –º–∞—Ä–∫–µ—Ä'} {/* –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ */}
        </button>

        {/* –ö–Ω–æ–ø–∫–∞ –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–æ–Ω */}
        <button 
          onClick={toggleEditMode} // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º —Ä–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏ –∫–ª–∏–∫–µ
          className={`${styles.controlButton} ${isEditing ? styles.active : ''}`} // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å 'active' –ø—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ–º —Ä–µ–∂–∏–º–µ
          title={isEditing ? '–ó–∞–≤–µ—Ä—à–∏—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–æ–Ω' : '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–æ–Ω—ã'} // –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –ø–æ–¥—Å–∫–∞–∑–∫–∞
        >
          {isEditing ? '‚úÖ –ó–∞–≤–µ—Ä—à–∏—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ' : '‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–æ–Ω—ã'} {/* –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ç–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏ */}
        </button>
        
      </div>
      
      {/* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å–∞–º–æ–π –∫–∞—Ä—Ç—ã - —Å—é–¥–∞ –±—É–¥–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω MapLibre */}
      <div ref={mapContainer} className={styles.mapInnerContainer}/>
    </div>
  );
}
